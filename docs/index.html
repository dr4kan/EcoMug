<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EcoMug: EcoMug: Efficient COsmic MUon Generator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">EcoMug<span id="projectnumber">&#160;2.0.0</span>
   </div>
   <div id="projectbrief">Efficient COsmic MUon Generator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a>: Efficient COsmic MUon Generator </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a> <a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a> is a header-only C++11 library for the generation of cosmic ray (CR) muons, based on a parametrization of experimental data. Unlike other tools, <a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a> gives the possibility of generating from different surfaces (plane, cylinder and half-sphere), while keeping the correct angular and momentum distribution of generated tracks. <a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a> also allows the generation of CR muons according to user-defined parametrizations of their differential flux.</p>
<p>If you use, or want to refer to, <a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a> please cite the following paper:</p>
<blockquote class="doxtable">
<p>&zwj;Pagano, D., Bonomi, G., Donzella, A., Zenoni, A., Zumerle, G., &amp; Zurlo, N. (2021). <a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a>: An Efficient COsmic MUon Generator for cosmic-ray muon applications. Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, Detectors and Associated Equipment, 1014, 165732. </p>
</blockquote>
<p>Latest release: <a href="https://github.com/dr4kan/EcoMug/releases/tag/v2.0.0">EcoMug v2.0.0</a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
Basic Usage</h1>
<p>The use of the library requires the initialization of the <code><a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a></code> class, the choice of the generation method, and the definition of the size and position of the generation surface. Once the setup of the instance of the <code><a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a></code> class is done, the generation of a cosmic-ray muon can be invoked with the method <code>Generate()</code>, which will compute its position, direction, momentum, and charge. All these quantities can be accessed with the methods <code>GetGenerationPosition()</code>, <code>GetGenerationTheta()</code>, <code>GetGenerationPhi()</code>, <code>GetGenerationMomentum()</code>, and <code>GetCharge()</code>, as shown in the examples below. The charge for generated muons takes into account the excess of positive muons over negative ones, assuming a constant charge ratio (see the above mentioned paper for more details). Angles are in radians, momentum is in GeV/c, whereas the unit of measure of the position is arbitrary and depends on the choice done in the simulation code where <a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a> is used.</p>
<h3><a class="anchor" id="autotoc_md2"></a>
Plane-based generation</h3>
<div class="fragment"><div class="line">EcoMug gen; // initialization of the class</div>
<div class="line">gen.SetUseSky(); // plane surface generation</div>
<div class="line">gen.SetSkySize({{10., 10.}}); // x and y size of the plane</div>
<div class="line">// (x,y,z) position of the center of the plane</div>
<div class="line">gen.SetSkyCenterPosition({{0., 0., 20.}});</div>
<div class="line"> </div>
<div class="line">// The array storing muon generation position</div>
<div class="line">std::array&lt;double, 3&gt; muon_position;</div>
<div class="line"> </div>
<div class="line">for (auto event = 0; event &lt; number_of_events; ++event) {</div>
<div class="line">  gen.Generate();</div>
<div class="line">  muon_position = gen.GetGenerationPosition();</div>
<div class="line">  double muon_p = gen.GetGenerationMomentum();</div>
<div class="line">  double muon_theta = gen.GetGenerationTheta();</div>
<div class="line">  double muon_phi = gen.GetGenerationPhi();</div>
<div class="line">  double muon_charge = gen.GetCharge();</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3"></a>
Cylinder-based generation</h3>
<div class="fragment"><div class="line">EcoMug gen; // initialization of the class</div>
<div class="line">gen.SetUseCylinder(); // cylindrical surface generation</div>
<div class="line">gen.SetCylinderRadius(10.); // cylinder radius</div>
<div class="line">gen.SetCylinderHeight(30.); // cylinder height</div>
<div class="line">// (x,y,z) position of the center of the cylinder</div>
<div class="line">gen.SetCylinderCenterPosition({{0., 0., 15.}});</div>
<div class="line"> </div>
<div class="line">// The array storing muon generation position</div>
<div class="line">std::array&lt;double, 3&gt; muon_position;</div>
<div class="line"> </div>
<div class="line">for (auto event = 0; event &lt; number_of_events; ++event) {</div>
<div class="line">  gen.Generate();</div>
<div class="line">  muon_position = gen.GetGenerationPosition();</div>
<div class="line">  double muon_p = gen.GetGenerationMomentum();</div>
<div class="line">  double muon_theta = gen.GetGenerationTheta();</div>
<div class="line">  double muon_phi = gen.GetGenerationPhi();</div>
<div class="line">  double muon_charge = gen.GetCharge();</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md4"></a>
Hsphere-based generation</h3>
<div class="fragment"><div class="line">EcoMug gen; // initialization of the class</div>
<div class="line">gen.SetUseHSphere(); // half-spherical surface generation</div>
<div class="line">gen.SetHSphereRadius(30.); // half-sphere radius</div>
<div class="line">// (x,y,z) position of the center of the half-sphere</div>
<div class="line">gen.SetHSphereCenterPosition({{0., 0., 0.}});</div>
<div class="line"> </div>
<div class="line">// The array storing muon generation position</div>
<div class="line">std::array&lt;double, 3&gt; muon_position;</div>
<div class="line"> </div>
<div class="line">for (auto event = 0; event &lt; number_of_events; ++event) {</div>
<div class="line">  gen.Generate();</div>
<div class="line">  muon_position = gen.GetGenerationPosition();</div>
<div class="line">  double muon_p = gen.GetGenerationMomentum();</div>
<div class="line">  double muon_theta = gen.GetGenerationTheta();</div>
<div class="line">  double muon_phi = gen.GetGenerationPhi();</div>
<div class="line">  double muon_charge = gen.GetCharge();</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md5"></a>
More Advanced Usage</h1>
<p>It is possible to set the seed in <a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a>, for reproducible generations. This can be done with the method <code>SetSeed</code>, as shown in the example below. If the seed is set to 0 (or the method is not invoked at all), a random seed is used.</p>
<div class="fragment"><div class="line">EcoMug gen;</div>
<div class="line">gen.SetUseSky();</div>
<div class="line">gen.SetSkySize({{10., 10.}});</div>
<div class="line">gen.SetSkyCenterPosition({{0., 0., 20.}});</div>
<div class="line"> </div>
<div class="line">// set the seed (only positive integers are accepted)</div>
<div class="line">gen.SetSeed(1234);</div>
</div><!-- fragment --><p>In several scenarios, one could be interested in generating tracks from a subset of these parameters, saving space and computation time. <a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a> allows this by exposing to the user the following methods:</p>
<ul>
<li><code>SetMinimumMomentum</code> - Set the minimum momentum for generated cosmic-ray muons;</li>
<li><code>SetMaximumMomentum</code> - Set the maximum momentum for generated cosmic-ray muons;</li>
<li><code>SetMinimumTheta</code> - Set the minimum zenith angle ùúÉ for generated cosmic-ray muons;</li>
<li><code>SetMaximumTheta</code> - Set the maximum zenith angle ùúÉ for generated cosmic-ray muons;</li>
<li><code>SetMinimumPhi</code> - Set the minimum azimuthal angle ùúô for generated cosmic-ray muons;</li>
<li><code>SetMaximumPhi</code> - Set the maximum azimuthal angle ùúô for generated cosmic-ray muons.</li>
</ul>
<div class="fragment"><div class="line">#include &lt;math.h&gt; // necessary for the M_PI constant</div>
<div class="line"> </div>
<div class="line">EcoMug gen;</div>
<div class="line">gen.SetUseSky();</div>
<div class="line">gen.SetSkySize({{10., 10.}});</div>
<div class="line">gen.SetSkyCenterPosition({{0., 0., 20.}});</div>
<div class="line"> </div>
<div class="line">gen.SetMinimumMomentum(80.);</div>
<div class="line">gen.SetMaximumMomentum(800.);</div>
<div class="line">gen.SetMinimumTheta(0.);</div>
<div class="line">gen.SetMaximumTheta(M_PI/4);</div>
<div class="line">gen.SetMinimumPhi(0.);</div>
<div class="line">gen.SetMaximumPhi(M_PI);</div>
</div><!-- fragment --><p>In those cases where the proposed parametrization of the differential flux <em>J</em> of CR muons does not fit the user needs, <a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a> gives the possibility to use a custom function for <em>J</em>, as shown in the example below.</p>
<div class="fragment"><div class="line">double J(double p, double theta) {</div>
<div class="line">  double A = 0.14*pow(p, -2.7);</div>
<div class="line">  double B = 1. / (1. + 1.1*p*cos(theta)/115.);</div>
<div class="line">  double C = 0.054 / (1. + 1.1*p*cos(theta)/850.);</div>
<div class="line">  return A*(B+C);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">EcoMug gen;</div>
<div class="line">gen.SetUseSky();</div>
<div class="line">gen.SetSkySize({{x, y}});</div>
<div class="line">gen.SetSkyCenterPosition({0., 0., z});</div>
<div class="line">gen.SetMinimumMomentum(150);</div>
<div class="line">gen.SetDifferentialFlux(&amp;J);</div>
<div class="line"> </div>
<div class="line">for (auto event = 0; event &lt; nevents; ++event) {</div>
<div class="line">  gen.GenerateFromCustomJ(); // generate from user-defined J</div>
<div class="line">  ... // retrieve and use muon data</div>
<div class="line">  gen.Generate(); // generate from J as in equation 2</div>
<div class="line">  ... // retrieve and use muon data</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md6"></a>
Rate and time estimation</h1>
<p><a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a> allows to estimate the rate and time to collect a given number of muons, also in those cases where the user has constrained the generation (for example by cutting on the momentum or angles). The user can specify the average expected rate (via <code>SetHorizontalRate</code>) to take into account, for example, the effect of altitude. Default value is 129 $Hz/m^2$.</p>
<p>While the rate and time estimation also works with custom definitions of the flux, it is up to the user to define a properly normalized J: <code>SetHorizontalRate</code> does not work in this case.</p>
<div class="fragment"><div class="line">EcoMug genPlane;</div>
<div class="line">genPlane.SetUseSky();</div>
<div class="line">genPlane.SetSkySize({{200.*EMUnits::cm, 200.*EMUnits::cm}});</div>
<div class="line">genPlane.SetSkyCenterPosition({0., 0., 1.*EMUnits::mm});</div>
<div class="line"> </div>
<div class="line">cout &lt;&lt; &quot;Estimated time [s] = &quot; &lt;&lt; genPlane.GetEstimatedTime(10000) &lt;&lt; endl;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
Deal with background</h1>
<p>The class <code><a class="el" href="class_e_m_multi_gen.html">EMMultiGen</a></code> allows to handle the generation of the background as well as the signal. It requires a <code><a class="el" href="class_eco_mug.html" title="Class for the generation of cosmic muons.">EcoMug</a></code> instance for the signal and one or more instances for the background. Additionally the user has to specify the differential flux (even unnormalized), the PID (<a href="https://pdg.lbl.gov/2007/reviews/montecarlorpp.pdf">Monte Carlo particle numbering scheme</a>) and the relative weight (w.r.t. signal) for all backgrounds.</p>
<div class="fragment"><div class="line">EcoMug muonGen;</div>
<div class="line">muonGen.SetUseSky();</div>
<div class="line">muonGen.SetSkySize({{200.*EMUnits::cm, 200.*EMUnits::cm}});</div>
<div class="line">muonGen.SetSkyCenterPosition({0., 0., 1.*EMUnits::mm});</div>
<div class="line"> </div>
<div class="line">EcoMug electronGen(muonGen);</div>
<div class="line">electronGen.SetDifferentialFlux(&amp;J);</div>
<div class="line"> </div>
<div class="line">EcoMug positronsGen(muonGen);</div>
<div class="line">electronGen.SetDifferentialFlux(&amp;J);</div>
<div class="line"> </div>
<div class="line">EMMultiGen genSuite(muonGen, {electronGen, positronsGen});</div>
<div class="line">genSuite.SetBckWeights({0.2, 0.1});</div>
<div class="line">genSuite.SetBckPID({11, -11});</div>
<div class="line"> </div>
<div class="line">map&lt;int, int&gt; counts;</div>
<div class="line">for (auto i = 0; i &lt; number_of_events; ++i) {</div>
<div class="line">  genSuite.Generate();</div>
<div class="line">  counts[genSuite.GetPID()]++;</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
